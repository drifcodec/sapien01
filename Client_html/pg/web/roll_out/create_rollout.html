<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <style>
        .td_table_label {
            width: 120px;
            height: 40px;
            padding: 4px 6px 0px 4px;
            padding-left: 15px;
            text-align: left;
            vertical-align: middle;
        }
        
        #example_processing {
            position: fixed;
            background: red;
            text-align: center;
            display: none !important;
            top: 50%;
            left: 50%;
            z-index: 11;
            color: white;
            padding: 10px;
        }
        
        .btn_update {
            border: 3px solid orange;
            background: white;
            color: orange;
        }
        
        .btn_change_password {
            border: 3px solid green;
            background: white;
            color: green;
        }
    </style>
    <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
    <script>
        $(document).ready(function() {
            $("#id").hide()
            $("#user_id").attr('readonly', 'readonly');
            console.log(localStorage)
            var api_url = `/api/user/user_get/${localStorage.Sapion_id}`
            $.ajax({
                url: api_url,
                dataType: 'json',
                contentType: 'application/json',
                type: "GET",
                success: function(data) {
                    //	alert(JSON.stringify(data.result))
                    $("#id").val(data.result.id)
                    $("#user_id").val(data.result.user_id)
                    $("#name").val(data.result.name)
                    $("#surname").val(data.result.surname)
                    $("#phone").val(data.result.phone)
                    $("#email").val(data.result.email)

                },
                error: function(XMLHttpRequest, textStatus, errorThrown) {}
            });

            $('#change_password').click(function() {
                console.log("_____")
                $('#change_password_module').modal();
            })
            $('#update').click(function() {
                var id = $('#id').val()
                console.log("--> ID -->", id)
                axios.put(`/api/user/user_update/${id}`, {
                        name: $('#name').val(),
                        surname: $('#surname').val(),
                        phone: $('#phone').val(),
                        email: $('#email').val(),
                    }).then(response => {
                        alert("Updated")
                        console.log("yes--->")
                    })
                    .catch(error => {
                        $("#delete_confirm").modal('hide');
                        console.log("Error Occured . Contact Admin" + error)
                    });
            })
            $('#save_new_password').click(function() {
                var stringify_data = {
                    "old_password": $('#old_password').val(),
                    "password": $('#new_password').val(),
                    "confirm_password": $('#confirm_password').val()
                };
                console.log(localStorage.SapionT)
                var key = localStorage.SapionT
                $.ajax({
                    url: `/api/user/change_password_email/${key}`,
                    type: "POST",
                    dataType: 'json',
                    data: stringify_data,
                    success: function(result) {
                        alert(" updated")
                            // self.location = "http://localhost:3000"
                    },
                    error: function(XMLHttpRequest, textStatus, errorThrown) {
                        alert("not updated")
                    }
                });

            })
        })
    </script>


    </script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <title>Sapien IO</title>
</head>

<body>
    <!-- Notice -->
    <div class="alert alert-success" role="alert">
        <h4 class="alert-heading">Notice!</h4>
        <p>You cant delete a Roll out once it has been sent </p>
    </div>
    <!-- user profile -->
    <div id="userProfile" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Create a Roll out</h5>
                </div>
                <div class="modal-body">
                    <form>

                        <div class="form-row">
                            <div class="form-group col-md-4">
                                <label for="inputState">Site</label>
                                <select id="inputState" class="form-control">
                              <option selected>Choose...</option>
                              <option>...</option>
                            </select>
                            </div>
                            <div class="form-group col-md-4">
                                <label for="inputState">Site Name</label>
                                <input type="text" class="form-control" id="siteName" readonly>
                            </div>
                            <div class="form-group col-md-4">
                                <label for="inputZip">Site Type</label>
                                <input type="text" class="form-control" id="siteType" readonly>
                            </div>
                        </div>
                        <!-- row 2 -->
                        <div class="form-row">
                            <div class="form-group col-md-4">
                                <label for="inputState">site Address</label>
                                <input type="text" class="form-control" id="siteAddress" readonly>
                            </div>
                            <div class="form-group col-md-4">
                                <label for="inputState">site Lattitude</label>
                                <input type="text" class="form-control" id="siteName" readonly>
                            </div>
                            <div class="form-group col-md-4">
                                <label for="inputZip">Site Longitude</label>
                                <input type="text" class="form-control" id="siteType" readonly>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group col-md-6">
                                <label for="inputEmail4">Category</label>
                                <select id="inputState" class="form-control">
                                    <option selected>Choose...</option>
                                    <option>...</option>
                                </select>
                            </div>
                            <div class="form-group col-md-6">
                                <label for="inputPassword4">Sub Category</label>
                                <select id="inputState" class="form-control">
                                    <option selected>Choose...</option>
                                    <option>...</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group col-md-6">
                                <label for="inputState">Operator</label>
                                <select id="inputState" class="form-control">
                              <option selected>Choose...</option>
                              <option>...</option>
                            </select>
                            </div>
                            <div class="form-group col-md-6">
                                <label for="inputState">Priority</label>
                                <select id="inputState" class="form-control">
                              <option selected>Choose...</option>
                              <option>...</option>
                            </select>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary">Submit</button>
                        <button type="submit" class="btn btn-primary">Cancel</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js" type="text/javascript"></script>
</body>

</html>